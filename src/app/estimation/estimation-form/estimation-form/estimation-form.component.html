<div class="form-container">
    <h2 class="form-title">Estimation Form</h2>
    <hr class="line">
    <form #estimationForm="ngForm" (ngSubmit)="onSubmit(estimationForm)" novalidate>
    <div class="section">
        <h3>Patient Information:</h3>
        <div class="form-row">
            <div class="input-container">
                <input  type="text"
                id="patientUHID"
                name="patientUHID"
                pattern="[A-Za-z0-9\-]+"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.patientUHID"
                placeholder=" "
                required />
                <label for="patientUHID" class="custom-label">UHID/MRD*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['patientUHID']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['patientUHID']?.errors?.['required']">UHID is required.</span>
                    <span *ngIf="estimationForm.controls['patientUHID']?.errors?.['pattern']">Invalid UHID format.</span>
                  </div>
            </div>
            <div class="input-container">
                <input type="text" 
                id="patientName" 
                name="patientName"
                placeholder=" " 
                class="custom-input" 
                pattern="^[a-zA-Z]*$" 
                ngModel
                [(ngModel)]="formData.patientName"
                placeholder=" "
                required />
                <label for="patientName" class="custom-label">Patient Name*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['patientName']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['patientName']?.errors?.['required']">Patient Name is required.</span>
                    <span *ngIf="estimationForm.controls['patientName']?.errors?.['pattern']">Invalid Name format.</span>
                  </div>
            </div>
        </div>
        <div class="form-row">
            <div class="input-container">
                <input type="number"
                 id="ageOfPatient"
                 name="ageOfPatient"  
                 placeholder=" "
                  class="custom-input" 
                  pattern="[A-Za-z0-9\-]+"  
                  ngModel
                  [(ngModel)]="formData.ageOfPatient"
                  required
                  min="0"
                  max="150"
                  />
                <label for="ageOfPatient" class="custom-label">Age*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['ageOfPatient']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['ageOfPatient']?.errors?.['required']">Age is required.</span>
                    <span *ngIf="estimationForm.controls['ageOfPatient']?.errors?.['pattern']">Invalid Age format.</span>
                    <span *ngIf="estimationForm.controls['ageOfPatient']?.errors?.['min']">Age must be greater than 0.</span>
            <span *ngIf="estimationForm.controls['ageOfPatient']?.errors?.['max']">Days cannot exceed 150.</span>
                  </div>
            </div>
            <div class="input-container">
                <input type="text" 
                id="genderOfPatient"
                name="genderOfPatient"
                pattern="(Male|Female|Other)"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.genderOfPatient"
                required
                placeholder=" " 
                class="custom-input" 
                />
                <label for="genderOfPatient" class="custom-label">Gender*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['genderOfPatient']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['genderOfPatient']?.errors?.['required']">Gender is required.</span>
                    <span *ngIf="estimationForm.controls['genderOfPatient']?.errors?.['pattern']">Enter Male, Female, or Other.</span>
                  </div>
            </div>
        </div>
    </div>

    <div class="section">
        <h3>Consultant Information:</h3>
        <div class="form-row">
            <div class="input-container">
                <input type="text" 
                id="consultantName"
                name="consultantName"
                pattern="^[a-zA-Z . ]*$"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.consultantName"
                required
                placeholder=" " class="custom-input" />
                <label for="consultantName" class="custom-label">Consultant Name*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['consultantName']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['consultantName']?.errors?.['required']">Consultant Name is required.</span>
                    <span *ngIf="estimationForm.controls['consultantName']?.errors?.['pattern']">Invalid Name format.</span>
                  </div>
            </div>
            <div class="input-container">
                <input type="date"
                 id="estimationPreferredDate"
                name="estimationPreferredDate"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.estimationPreferredDate"
                required
                placeholder=" " class="custom-input" />
                <label for="estimationPreferredDate" class="custom-label">Preferred Date by Doctor*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['estimationPreferredDate']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['estimationPreferredDate']?.errors?.['required']">Preferred Date by Doctor is required.</span>
                    <span *ngIf="estimationForm.controls['estimationPreferredDate']?.errors?.['pattern']">Invalid Date format.</span>
                  </div>
            </div>
        </div>
        <div class="form-row">
            <div class="input-container">
                <input type="text" 
                id="estimationName"
                name="estimationName"
                pattern="^[a-zA-Z]*$"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.estimationName"
                required
                placeholder=" " class="custom-input" />
                <label for="estimationName" class="custom-label">Surgery Name*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['estimationName']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['estimationName']?.errors?.['required']">Surgery Name is required.</span>
                    <span *ngIf="estimationForm.controls['estimationName']?.errors?.['pattern']">Invalid Name format.</span>
                  </div>
            </div>
            <div class="input-container">
                <input type="text" 
                 id="remarks"
                name="remarks"
                pattern="^[a-zA-Z]*$"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.remarks"
                required
                placeholder=" " class="custom-input" />
                <label for="remarks" class="custom-label">Remarks</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['remarks']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['remarks']?.errors?.['required']">Remarks is required.</span>
                    <span *ngIf="estimationForm.controls['remarks']?.errors?.['pattern']">Invalid Remarks format.</span>
                  </div>
            </div>
        </div>
    </div>

    <div class="section">
        <h3>Estimated Hospital Stay (No. of Days):</h3>
        <div class="form-row">
            <div class="input-container">
                <input type="number" 
                 id="icuStay"
                name="icuStay"
                 pattern="^[0-9]*$"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.icuStay"
                required
                placeholder=" " class="custom-input" />
                <label for="icuStay" class="custom-label">No. of Days for ICU*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['icuStay']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['icuStay']?.errors?.['required']">No. of Days is required.</span>
                    <span *ngIf="estimationForm.controls['icuStay']?.errors?.['pattern']">Invalid format.</span>
                  </div>
            </div>
            <div class="input-container">
                <input type="number" 
                 id="wardStay"
                name="wardStay"
                 pattern="^[0-9]*$"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.wardStay"
                required
                placeholder=" " class="custom-input" />
                <label for="wardStay" class="custom-label">No. of Days for Ward*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['wardStay']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['wardStay']?.errors?.['required']">No. of Days is required.</span>
                    <span *ngIf="estimationForm.controls['wardStay']?.errors?.['pattern']">Invalid format.</span>
                  </div>
            </div>
        </div>
        <div class="form-row">
            <div class="input-container">
              
              <select
                id="roomType"
                name="roomType"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.roomType"
                required
                #roomType="ngModel"
              >
                <option value="" disabled selected>Select Room Type</option>
                <option value="General">General</option>
                <option value="Semi-Private">Semi-Private</option>
                <option value="Private">Private</option>
              </select>
              <label for="roomType" class="custom-label">Room Type*</label>
              <div *ngIf="estimationForm.submitted && estimationForm.controls['roomType']?.invalid" class="error-message">
                <span *ngIf="estimationForm.controls['roomType']?.errors?.['required']">Room Type is required.</span>
              </div>
            </div>
          </div>
          
    </div>

    <div class="section">
        <h3>Inclusions and Exclusions:</h3>
        <div class="checkbox-grid">
            <label>
              <input
                type="checkbox"
                name="inclusions"
                [(ngModel)]="formData.includedItems['wardICUStay']"
              />
              Ward and ICU Stay
            </label>
            <label>
              <input
                type="checkbox"
                name="includedItems"
                [(ngModel)]="formData.includedItems['primaryConsultant']"
              />
              Primary Consultant
            </label>
            <label>
              <input
                type="checkbox"
                name="includedItems"
                [(ngModel)]="formData.includedItems['crossConsultation']"
              />
              Cross Consultation
            </label>
            <label>
              <input
                type="checkbox"
                name="includedItems"
                [(ngModel)]="formData.includedItems['implants']"
              />
              Implants
            </label>
            <label>
              <input
                type="checkbox"
                name="includedItems"
                [(ngModel)]="formData.includedItems['laboratoryImaging']"
              />
              Laboratory and Imaging
            </label>
            <label>
              <input
                type="checkbox"
                name="includedItems"
                [(ngModel)]="formData.includedItems['instrumentEquipment']"
              />
              Instrument/Equipment
            </label>
            <label>
              <input type="checkbox" name="includedItems" [(ngModel)]="formData.includedItems['diet']" />
              Diet
            </label>
            <label>
              <input type="checkbox" name="includedItems" [(ngModel)]="formData.includedItems['nursing']" />
              Nursing
            </label>
            <label>
              <input
                type="checkbox"
                name="includedItems"
                [(ngModel)]="formData.includedItems['surgeonOTAnesthesia']"
              />
              Surgeon, OT, Anesthesia
            </label>
            <label>
              <input
                type="checkbox"
                name="includedItems"
                [(ngModel)]="formData.includedItems['bedsideProcedure']"
              />
              Bedside Procedure
            </label>
            <label>
              <input
                type="checkbox"
                name="includedItems"
                [(ngModel)]="formData.includedItems['otDrugs']"
              />
              OT Drugs
            </label>
            <label>
              <input
                type="checkbox"
                name="includedItems"
                [(ngModel)]="formData.includedItems['drugsConsumables']"
              />
              Drugs and Consumables
            </label>
          </div>
          <div *ngIf="!isAnyCheckboxChecked && estimationForm.submitted" class="error-message">
            At least one inclusion must be selected.
          </div>
          
    </div>

    <div class="section">
        <h3>Estimation Details:</h3>
        <div class="form-row">
            <div class="input-container">
                <input type="date" 
                 id="estimationDate"
                name="estimationDate"
                class="custom-input"
                ngModel
                [(ngModel)]="formData.estimationDate"
                required
                placeholder=" " class="custom-input"  />
                <label for="estimationDate" class="custom-label">Estimated Date*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['estimationDate']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['estimationDate']?.errors?.['required']">Estimated Date is required.</span>
                    <span *ngIf="estimationForm.controls['estimationDate']?.errors?.['pattern']">Invalid format.</span>
                  </div>
            </div>
        </div>
        <div class="form-row">
            <div class="input-container">
                <input type="number"
                id="estimationCost"
               name="estimationCost"
               pattern="^[0-9]*$"
               class="custom-input"
               ngModel
               [(ngModel)]="formData.estimationCost"
               required
               placeholder=" " class="custom-input" />
                <label for="estimationCost" class="custom-label">Estimation Cost*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['estimationCost']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['estimationCost']?.errors?.['required']">Estimation Cost is required.</span>
                    <span *ngIf="estimationForm.controls['estimationCost']?.errors?.['pattern']">Invalid Cost format.</span>
                  </div>
            </div>
            <div class="input-container">
                <input type="number" 
                id="discountPercentage"
               name="discountPercentage"
               pattern="^[0-9]*$"
               class="custom-input"
               ngModel
               [(ngModel)]="formData.discountPercentage"
               required
               placeholder=" " class="custom-input" />
                <label for="discountPercentage" class="custom-label">Applicable Discount*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['discountPercentage']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['discountPercentage']?.errors?.['required']">Discount is required.</span>
                    <span *ngIf="estimationForm.controls['discountPercentage']?.errors?.['pattern']">Invalid Discount format.</span>
                  </div>
            </div>
        </div>
        <div class="form-row">
            <div class="input-container">
                <input type="number"
                id="totalEstimationAmount"
               name="totalEstimationAmount"
               pattern="^[0-9]*$"
               class="custom-input"
               ngModel
               [(ngModel)]="formData.totalEstimationAmount"
               required
               placeholder=" " class="custom-input"  />
                <label for="totalEstimationAmount" class="custom-label">Grand Total*</label>
                <div *ngIf="estimationForm.submitted && estimationForm.controls['totalEstimationAmount']?.invalid" class="error-message">
                    <span *ngIf="estimationForm.controls['totalEstimationAmount']?.errors?.['required']">Grand Total is required.</span>
                    <span *ngIf="estimationForm.controls['totalEstimationAmount']?.errors?.['pattern']">Invalid Grand Total format.</span>
                  </div>
            </div>
        </div>
    </div>

    <!-- <div class="section">
        <h3>Signature:</h3>
        <div class="form-row">
            <div class="input-container">
                <label>Signature of:</label>
                <div>
                    <input type="radio" name="signature" /> Patient
                    <input type="radio" name="signature" /> Attender
                </div>
            </div>
            <div class="input-container">
                <input type="text" placeholder=" " class="custom-input" />
                <label class="custom-label">Signature of Staff:</label>
            </div>
            <div class="input-container">
                <input type="text" placeholder=" " class="custom-input" />
                <label class="custom-label">Approver Signature:</label>
            </div>
        </div>
    </div> -->
    <div class="section">
        <div class="note">
          <p>
            <strong>Note:</strong><br>
            This estimate is based on the information available at the time of the request. Actual charges may vary based on the patient’s specific circumstances and any unforeseen complications that may arise during the procedure/treatment.
          </p>
        </div>
      
        <div class="signature-container-1">
          <div class="signature-section">
            <label class="sign">Signature of:</label>
            <div class="radio-buttons">
              <input type="radio" id="patient" name="signatureOf" value="patient"  [(ngModel)]="formData.signatureOf" required/>
              <label for="patient" class="sign">Patient</label>
              <input type="radio" id="attender" name="signatureOf" value="attender"  [(ngModel)]="formData.signatureOf" />
              <label for="attender" class="sign">Attender</label>
            </div>
            <canvas #patientSignatureCanvas width="500" height="300" style="border: 1px solid black;"></canvas>
            <!-- <button (click)="saveSignature()">Save</button>
            <button (click)="clearSignature()">Clear</button> -->
          </div>
      </div>
      <div class="signature-container">
        <div class="signature-section">
            <label class="sign">Staff Signature</label>
            <canvas #staffSignatureCanvas width="500" height="300" style="border: 1px solid black;"></canvas>
            <div class="input-container">
                <input
              type="text"
              id="staffName"
              name="staffName"
              pattern="^[a-zA-Z]*$"
              class="custom-input"
              ngModel
              [(ngModel)]="formData.staffName"
              required
              placeholder=" " class="custom-input" 
            />
            <label for="staffName" class="custom-label">Staff Name*</label>
            <div *ngIf="estimationForm.submitted && estimationForm.controls['staffName']?.invalid" class="error-message">
                <span *ngIf="estimationForm.controls['staffName']?.errors?.['required']">Staff Name is required.</span>
                <span *ngIf="estimationForm.controls['staffName']?.errors?.['pattern']">Invalid Name format.</span>
              </div>
            </div>
          </div>
      
          <div class="signature-section">
            <label class="sign" >Approver Signature:</label>
            <canvas #approverSignatureCanvas width="500" height="300" style="border: 1px solid black;"></canvas>
            <div class="input-container">
                <input
              type="text"
              id="approverName"
              name="approverName"
              pattern="^[a-zA-Z]*$"
              class="custom-input"
              ngModel
              [(ngModel)]="formData.approverName"
              required
              placeholder=" " class="custom-input" 
            />
            <label for="approverName" class="custom-label">Approver Name*</label>
            <div *ngIf="estimationForm.submitted && estimationForm.controls['approverName']?.invalid" class="error-message">
                <span *ngIf="estimationForm.controls['approverName']?.errors?.['required']">Approver Name is required.</span>
                <span *ngIf="estimationForm.controls['approverName']?.errors?.['pattern']">Invalid Name format.</span>
              </div>
            </div>
          </div>
      </div>
          
        </div>
      
    <div>
        <button type="submit" class="submit-button">Save</button>
    </div>
</form>
</div>